---
title: "–û—Ç—á—ë—Ç –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ3 –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ \"–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ\""
author: "–®–∞–π—Ö–ª—å–±–∞—Ä–∏–Ω –î–µ–Ω–∏—Å –ú–∞—Ä–∞—Ç–æ–≤–∏—á"
date: '–í—ã–ø–æ–ª–Ω–µ–Ω–æ: `r Sys.Date()`'
output:
  html_document:
    df_print: paged
  pdf_document:
    latex_engine: xelatex
  word_document: default
mainfont: Arial
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
Sys.setlocale("LC_CTYPE",  "English")
Sys.setlocale("LC_CTYPE",  "Russian")
```

```{r}
library(ggplot2)
library(memisc)
library(DescTools)
library(broom)
library(caTools)
library(lmtest)
library(dplyr)
library(readxl)

```
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ (—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å) –æ—Ç—Ä–∞–∂–∞–µ—Ç 
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: –º–µ–∂–¥—É –æ–¥–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ–π (—ç–Ω–¥–æ–≥–µ–Ω–Ω–æ–π, –æ–±—ä—è—Å–Ω—è–µ–º–æ–π) –∏ 
–æ–¥–Ω–æ–π –∏–ª–∏ –∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ (—ç–∫–∑–æ–≥–µ–Ω–Ω—ã–º–∏, –æ–±—ä—è—Å–Ω—è—é—â–∏–º–∏) –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ 
(—Ñ–∞–∫—Ç–æ—Ä–∞–º–∏, —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä–∞–º–∏). –ó–∞–≤–∏—Å–∏–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è –∫–∞–∫ y, –∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ 
–æ–±—ä—è—Å–Ω—è—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ x1, x2, ‚Ä¶ , xn.
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –£—Ä–∞–≤–Ω–µ–Ω–∏–µ, –æ—Ç—Ä–∞–∂–∞—é—â–µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º 
–æ–∂–∏–¥–∞–Ω–∏–µ–º (—É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è) –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ 
–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥—Ä—É–≥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º.

–ù–∞–ª–∏—á–∏–µ —Å–ª—É—á–∞–π–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ –¥–≤—É–º—è –ø—Ä–∏—á–∏–Ω–∞–º–∏:
‚Ä¢ –ª—é–±–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É–ø—Ä–æ—â–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞ —Å–∞–º–æ–º 
–¥–µ–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö —Ç–∞–∫–∂–µ –∑–∞–≤–∏—Å–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è Yi);
‚Ä¢ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—à–∏–±–∫–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –û–¥–Ω–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–º –ª–∏–Ω–µ–π–Ω—ã–º —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è 
—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π y –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º 
(—Ä–µ–≥—Ä–µ—Å—Å–æ—Ä–æ–º) —Ö, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –≤ –≤–∏–¥–µ –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
ùë¶ = ùëé + ùëèùë• + ùúÄ –∏–ª–∏ ùë¶ùëñ = ùëé + ùëèùë•ùëñ + ùúÄùëñ

–ê–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è ‚Äì —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –µ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–º—É 
–º–æ–¥–µ–ª–∏—Ä—É–µ–º–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è:
1. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–¥–≥–æ–Ω–∫–∏.
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≥–∏–ø–æ—Ç–µ–∑ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É—Ä–∞–≤–Ω–µ–Ω–∏—è.
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ—Å–º–µ—â–µ–Ω–Ω—ã—Ö, 
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫ –∏ .
4. –°–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏.
5. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–æ–¥–µ–ª–∏.

–û—Å—Ç–∞—Ç–∫–∏ ‚Äì —ç—Ç–æ —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∏—Å—Ö–æ–¥–Ω—ã–º–∏ (–Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏) –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∑–∞–≤–∏—Å–∏–º–æ–π 
–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –ò—Å—Å–ª–µ–¥—É—è –æ—Å—Ç–∞—Ç–∫–∏, –º—ã –º–æ–∂–µ–º –æ—Ü–µ–Ω–∏—Ç—å —Å—Ç–µ–ø–µ–Ω—å 
–∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –æ–ø—ã—Ç–Ω—ã–º –¥–∞–Ω–Ω—ã–º. 
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –æ—Å—Ç–∞—Ç–∫–æ–≤ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è. 
–ü–æ—ç—Ç–æ–º—É –≤ –∑–∞–¥–∞—á—É —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—Ö–æ–¥–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–∞–º–æ–π –º–æ–¥–µ–ª–∏, –Ω–æ 
–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω.

–ó–∞–≥—Ä—É–∑–∏–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ‚àí diamond.

```{r}
dmnds <- diamonds
```

–†–∞–∑–¥–µ–ª–∏–º –≤—ã–±–æ—Ä–∫—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤—É—é –∏ –æ–±—É—á–∞—é—â—É—é.

```{r}
set.seed(56)

split <- sample.split(dmnds$price, SplitRatio = 0.75)

train <- subset(dmnds, split == TRUE)
test <- subset(dmnds, split == FALSE)
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –í –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
–≤—ã—Å—Ç—É–ø–∞–µ—Ç ‚Äì price, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π ‚Äì carat. –í—ã–≤–æ–¥–∏–º –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

```{r}
model_1 <- lm(data = train, price ~ carat)

summary(model_1)
```
–°–æ–≥–ª–∞—Å–Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏–º–µ–µ—Ç –≤–∏–¥:
price = -2317.63 + 7900.65 * carat


–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:

```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(lm(data = train, price ~ carat))$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(lm(data = train, price ~ carat))$adj.r.squared 
```

–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(lm(data = train, price ~ carat))$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- abs(sum((train$price - model_1$fitted.values)/train$price)) / nrow(train) * 100
str(A)
```

–ê < 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ —Ö–æ—Ä–æ—à–µ–µ


–ü—Ä–∏–º–µ–Ω–∏–≤ —Ñ—É–Ω–∫—Ü–∏—é glance(), –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –Ω–∞–π—Ç–∏ –≤—ã—à–µ–æ–ø–∏—Å–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```{r}
glance(model_1)
```

### –ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ—Å–º–µ—â–µ–Ω–Ω—ã—Ö, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫

*–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã*. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ (—Ä–∞–∑–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª—å–Ω—ã—Ö –∏ –∏—Å—Ç–∏–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price) –æ—Ç —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–¥–µ–ª–∏

```{r}
qplot(y = model_1$fitted.values, x = model_1$residuals, xlab = "–û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã, Ei", ylab="–°–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, y^")
```
\
*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ M(Ei) = 0.*
\
H0: M(Ei) = 0(–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ä–∞–≤–Ω–æ –Ω—É–ª—é);\
H1: M(Ei) != 0(–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç–ª–∏—á–Ω–æ –æ—Ç –Ω—É–ª—è).\

```{r}
mean(model_1$residuals)
```

–í—ã—á–∏—Å–ª—è–µ–º t —Ä–∞—Å—á.:

```{r}
a<-mean(model_1$residuals)
b<-sd(model_1$residuals, na.rm = FALSE)
n <- sqrt(42126)

tm <- a/b*n
str(tm)
```

–í—ã—á–∏—Å–ª—è–µ–º t —Ç–∞–±–ª. –ø—Ä–∏ p=0.95 –∏ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã N-1:


```{r}
df <- nrow(train)

qt(0.95, df - 1)
```
|t —Ä–∞—Å—á.| < t —Ç–∞–±–ª. => –ø—Ä–∏–Ω–∏–º–∞–µ–º H0 —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é p=0.95.


*–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏* –≤ –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é *—Ç–µ—Å—Ç–∞ –ë—Ä–æ–π—à–∞-–ü–æ–≥–∞–Ω–∞*:
H0: D(Ei) = sig^2 (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏, –Ω–∞–ª–∏—á–∏–µ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏)
H1: D(Ei) != sig^2 (–Ω–∞–ª–∏—á–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏)

```{r}
bptest(model_1)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –º–µ–Ω—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.


*–ù–∞–ª–∏—á–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –≤ –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ç–µ—Å—Ç–∞ —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞*. 

–°—É—Ç—å —Ç–µ—Å—Ç–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω–∞–ª–∏—á–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ä–æ—Å—Ç–æ–º –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Ä–æ—Å—Ç–æ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞, —Ç–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤. –¢–∞–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞ œÅ –º–µ–∂–¥—É –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –º–æ–¥–µ–ª–∏ E –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º carat.


```{r}
cor.test (train$carat, model_1$residuals, method = "spearman")
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –º–µ–Ω—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.


*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ cov(Ei,Ej)=0, i!=j*

–ù0: rho=0 (—Ç.–µ. –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: rho>0 –∏–ª–∏ rho<0 (–Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤). 

```{r}
# —Ç–µ—Å—Ç –î–∞—Ä–±–∏–Ω–∞-–£–æ—Ç—Å–æ–Ω–∞
bgtest(model_1)

# —Ç–µ—Å—Ç –ë—Ä–æ–π—à–∞- –ì–æ–¥—Ñ—Ä–∏
dwtest(model_1)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –º–µ–Ω—å—à–µ 0.05 => –≥–∏–ø–æ—Ç–µ–∑–∞ H0 –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.


*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ Ei ~ N(0, sig^2)*, —Ç.–µ. —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è –ª–∏ –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º:

H0: –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
H1: –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:

```{r}
qqnorm(model_1$residuals)
```

```{r}
library(sm);
Z <- model_1$residuals
hist(Z, main = "–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤")

sm.density(model_1$residuals, model = "Normal",xlab = "–û—Å—Ç–∞—Ç–∫–∏", ylab = "–§—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", xlim=c(-19246.62,12642.95))
```


**–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:**

```{r}
library(nortest)

# —Ç–µ—Å—Ç Lilliefors (Kolmogorov-Smirnov) 
lillie.test(model_1$residuals)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –º–µ–Ω—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ —Å–æ–≥–ª–∞—Å–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.

**–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∞–∫–∂–µ —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞**. –î–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –æ–±—ä–µ–º–∞ –Ω–µ –º–µ–Ω–µ–µ 3 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏ –Ω–µ –±–æ–ª–µ–µ 5000. –î–ª—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π –≤—ã–±–æ—Ä–∫–µ –≤—ã–±–µ—Ä–µ–º 4990 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏.

```{r}
# —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞
sh <- model_1$residuals[1:4990]
#View(sh)
shapiro.test(sh)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –º–µ–Ω—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ —Å–æ–≥–ª–∞—Å–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.

–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:

```{r}
plot(test$carat, test$price, xlab="–ö–∞—Ä–∞—Ç", ylab="–¶–µ–Ω–∞")
lines(test$carat, predict(model_1, test), col = 'red')
```







### –¶–µ–ª—å
–ü—Ä–æ–≤–µ—Å—Ç–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º —Å–µ—Ä–¥–µ—á–Ω—ã—Ö —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π (thalach), –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

- age - –≤–æ–∑—Ä–∞—Å—Ç
- sex - –ø–æ–ª
- cp - —Ç–∏–ø –±–æ–ª–∏ –≤ –≥—Ä—É–¥–∏ 
- trestbps - –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–∫–æ—è
- chol - —É—Ä–æ–≤–µ–Ω—å —Ö–æ–ª–µ—Å—Ç–µ—Ä–æ–ª–∞ –≤ —Å—ã–≤–æ—Ä–æ—Ç–∫–µ –∫—Ä–æ–≤–∏
- restecg - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–∫–∞—Ä–¥–∏–æ–≥—Ä–∞—Ñ–∏–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–∫–æ—è
- exang - –Ω–∞–ª–∏—á–∏–µ —Å—Ç–µ–Ω–æ–∫–∞—Ä–¥–∏–∏
- oldpeak - –¥–µ–ø—Ä–µ—Å—Å–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞ ST —Å–µ—Ä–¥—Ü–∞

–ó–∞–≥—Ä—É–∑–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
```{r}
library(openxlsx)
library(caTools)
library(DescTools)
library(dplyr)
library(ggplot2)
library(glmnet)
library(tidyverse)

```

–ó–∞–≥—Ä—É–∑–∏–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –ò—Å—Ç–æ—á–Ω–∏–∫ - https://www.kaggle.com/imnikhilanand/heart-attack-prediction
```{r}
data <- read.csv("data.csv", sep = ",")
```

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–º –ª–∏–Ω–µ–π–Ω—ã–º —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è 
—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π y –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏ 
(—Ä–µ–≥—Ä–µ—Å—Å–æ—Ä–∞–º–∏) x1, x2, ‚Ä¶ , xk, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –≤ –≤–∏–¥–µ –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å ‚Äì —ç—Ç–æ –Ω–∞–ª–∏—á–∏–µ —Ç–µ—Å–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ 
–º–µ–∂–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏.
–ü—Ä–∏–∑–Ω–∞–∫–∏ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏:
1.–û—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–º–µ—é—Ç –±–æ–ª—å—à–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏, –º–∞–ª—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, —Ö–æ—Ç—è 
—Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ —Ü–µ–ª–æ–º —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–∏–º–æ–π (–∑–∞–≤—ã—à–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, R).
2. –ù–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é 
–æ—Ü–µ–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏.
3. –û—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–º–µ—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –∑–Ω–∞–∫–∏ –∏–ª–∏ 
–Ω–µ–æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–ü—É—Ç–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏:
‚Ä¢ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –º–æ–¥–µ–ª–∏ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (–ø—Ä–∏ —ç—Ç–æ–º —Å–ª–µ–¥—É–µ—Ç 
—É—á–∏—Ç—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏); 
‚Ä¢ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏ 
(–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫ –∏—Ö —Ä–∞–∑–Ω–æ—Å—Ç—è–º).
‚Ä¢ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç–æ–¥–∞ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º–µ—Ç–æ–¥–∞ –≥–ª–∞–≤–Ω—ã—Ö 
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–ú–ì–ö).
‚Ä¢ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤: –≥—Ä–µ–±–Ω–µ–≤–æ–π 
—Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –º–µ—Ç–æ–¥–∞ Lasso.

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–≥—Ä–µ—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ —Ä–∞–∑–¥–µ–ª–∏–º –≤—ã–±–æ—Ä–∫—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤—É—é –∏ –æ–±—É—á–∞—é—â—É—é
```{r}
set.seed(1821)

split <- sample.split(data$thalach, SplitRatio = 0.75)
train <- subset(data, split == TRUE)
test <- subset(data, split == FALSE)
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤)
```{r}
m_lm <- lm(thalach ~ ., data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å
F-–∫—Ä–∏—Ç–µ—Ä–∏–π
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∏—Å–∫–ª—é—á–∏–≤ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä chol
```{r}
m_lm <- lm(thalach ~ age + sex + cp + trestbps + restecg + exang + oldpeak, data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å\
F-–∫—Ä–∏—Ç–µ—Ä–∏–π\
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);\
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

\| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.
\
*–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏*:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∏—Å–∫–ª—é—á–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä sex
```{r}
m_lm <- lm(thalach ~ age + cp + trestbps + restecg + exang + oldpeak, data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å
F-–∫—Ä–∏—Ç–µ—Ä–∏–π
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∏—Å–∫–ª—é—á–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä restecg
```{r}
m_lm <- lm(thalach ~ age + cp + trestbps + exang + oldpeak, data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å
F-–∫—Ä–∏—Ç–µ—Ä–∏–π
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∏—Å–∫–ª—é—á–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä trestbps
```{r}
m_lm <- lm(thalach ~ age + cp + exang + oldpeak, data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å
F-–∫—Ä–∏—Ç–µ—Ä–∏–π
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∏—Å–∫–ª—é—á–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä oldpeak
```{r}
m_lm <- lm(thalach ~ age + cp + exang, data = train)
summary(m_lm)
```

–ü—Ä–æ–≤–µ—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é —Å–≤—è–∑—å
F-–∫—Ä–∏—Ç–µ—Ä–∏–π
H0: a=b 0 , (—Ç.–µ. –ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É x –∏ y –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
H1: a>0 –∏–ª–∏ b>0 (—Ç.–µ. –Ω–∞–ª–∏—á–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏).

```{r}
mean_model <- mean(train$thalach)
f <- sum((m_lm$fitted.values - mean_model)^2) / summary(m_lm)$sigma^2
f

f_tabl <- qf(0.95, 1, nrow(train)-2)
f_tabl
```

| F —Ä–∞—Å—á | > F —Ç–∞–±–ª => –æ—Ç–≤–µ—Ä–≥–∞–µ–º H0 –≤ –ø–æ–ª—å–∑—É –Ω–∞–ª–∏—á–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏:
```{r}
#–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
summary(m_lm)$r.squared 

#–∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å–∫–æ—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–¥–æ–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π price)
summary(m_lm)$adj.r.squared 
```

–ó–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏ (–Ω–∏–∂–µ 0.5), –ø–æ–¥–≥–æ–Ω–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π


–ù–∞—Ö–æ–¥–∏–º –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é:
```{r}
summary(m_lm)$sigma^2
```

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ 
```{r}
A <- sum(abs((train$thalach - m_lm$fitted.values)/train$thalach)) / nrow(train) * 100
str(A)
```

–ê > 5-7% => –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–ª–æ—Ö–æ–µ

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$predict <- predict(m_lm, test)

ggplot(test, aes(x = thalach, y = predict)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –∫–∞–∫ –±—ã–ª–æ, —Ç–∞–∫ –∏ –æ—Å—Ç–∞–ª–æ—Å—å –ø–ª–æ—Ö–∏–º, —Å –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–¥–≥–æ–Ω–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å –≤—Å—ë –Ω–∏–∂–µ –∏ –Ω–∏–∂–µ.


### –ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ—Å–º–µ—â–µ–Ω–Ω—ã—Ö, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫

*–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã*. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ (—Ä–∞–∑–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª—å–Ω—ã—Ö –∏ –∏—Å—Ç–∏–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π thalach) –æ—Ç —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–¥–µ–ª–∏

```{r}
qplot(y = m_lm$fitted.values, x = m_lm$residuals, xlab = "–û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã, Ei", ylab="–°–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, y^")
```

*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ M(Ei) = 0 (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ—Å—Ç—å)*
\
H0: M(Ei) = 0(–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ä–∞–≤–Ω–æ –Ω—É–ª—é);\
H1: M(Ei) != 0(–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç–ª–∏—á–Ω–æ –æ—Ç –Ω—É–ª—è).\

```{r}
mean(m_lm$residuals)
```

–í—ã—á–∏—Å–ª—è–µ–º t —Ä–∞—Å—á.:
```{r}
a<-mean(m_lm$residuals)
b<-sd(m_lm$residuals, na.rm = FALSE)
n <- sqrt(nrow(train)) #209 - –∫–æ–ª-–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π

tm <- a/b*n
str(tm)
```

–í—ã—á–∏—Å–ª—è–µ–º t —Ç–∞–±–ª. –ø—Ä–∏ p=0.95 –∏ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã N-1:
```{r}
df <- nrow(train)

qt(0.95, df - 1)
```
|t —Ä–∞—Å—á.| < t —Ç–∞–±–ª. => –ø—Ä–∏–Ω–∏–º–∞–µ–º H0 —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é p=0.95.


*–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏* –≤ –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é *—Ç–µ—Å—Ç–∞ –ë—Ä–æ–π—à–∞-–ü–æ–≥–∞–Ω–∞*:
H0: D(Ei) = sig^2 (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏, –Ω–∞–ª–∏—á–∏–µ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏)
H1: D(Ei) != sig^2 (–Ω–∞–ª–∏—á–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏)
```{r}
bptest(m_lm)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –±–æ–ª—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è.


*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ cov(Ei,Ej)=0, i!=j*
\
–ù0: rho=0 (—Ç.–µ. –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);\
H1: rho>0 –∏–ª–∏ rho<0 (–Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤).\
```{r}
# —Ç–µ—Å—Ç –î–∞—Ä–±–∏–Ω–∞-–£–æ—Ç—Å–æ–Ω–∞
bgtest(m_lm)

# —Ç–µ—Å—Ç –ë—Ä–æ–π—à–∞- –ì–æ–¥—Ñ—Ä–∏
dwtest(m_lm)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –±–æ–ª—å—à–µ 0.05 => –≥–∏–ø–æ—Ç–µ–∑–∞ H0 –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è



*–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å–ª–æ–≤–∏–µ Ei ~ N(0, sig^2)*, —Ç.–µ. —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è –ª–∏ –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º:
\
H0: –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è;\
H1: –æ—Å—Ç–∞—Ç–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è\

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:

```{r}
qqnorm(m_lm$residuals)
```

```{r}
library(sm);
Z <- m_lm$residuals
hist(Z, main = "–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤")

sm.density(m_lm$residuals, model = "Normal",xlab = "–û—Å—Ç–∞—Ç–∫–∏", ylab = "–§—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è")
```

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:
```{r}
library(nortest)

# —Ç–µ—Å—Ç Lilliefors (Kolmogorov-Smirnov) 
lillie.test(m_lm$residuals)
```

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ p-value –±–æ–ª—å—à–µ 0.05, –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –æ —Å–æ–≥–ª–∞—Å–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è


*–ê–Ω–∞–ª–∏–∑ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏*:

–ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å ‚Äì —ç—Ç–æ –Ω–∞–ª–∏—á–∏–µ —Ç–µ—Å–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏.

–í—ã—á–∏—Å–ª–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ VIF
```{r}
VIF(m_lm)
```

–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ, —É—á–∏—Ç—ã–≤–∞—è –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
```{r}
train_y <- train$thalach
train_x <- data.frame(age=train$age, cp=train$cp, exang=train$exang) %>% data.matrix()
test_x <- data.frame(age=test$age, cp=test$cp, exang=test$exang)  %>% data.matrix()
```

–ü—Ä–∏–º–µ–Ω–∏–º –º–µ—Ç–æ–¥—ã –†–∏–¥–∂ –∏ Lasso –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å —Ü–µ–ª—å—é —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π. –ú–µ—Ç–æ–¥—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –†–∏–¥–∂ –∏ LASSO –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –º–µ—Ç–æ–¥–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤.

–ì—Ä–µ–±–Ω–µ–≤–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (—Ä–∏–¥–∂-–æ—Ü–µ–Ω–∫–∏).
–ì—Ä–µ–±–Ω–µ–≤–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏, 
–∫—Ä–æ–º–µ —Ç–æ–≥–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–º–µ—â–µ–Ω–Ω—ã–º –æ—Ü–µ–Ω–∫–∞–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –Ω–æ 
–ø–æ–≤—ã—à–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ —Ü–µ–ª–æ–º. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–∞—Ä–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å 
¬´–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ¬ª —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –∑–Ω–∞–∫–∏ –≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –≥—Ä–µ–±–Ω–µ–≤–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø—Ä–∏–∑–≤–∞–Ω–∞ 
—É—Å—Ç—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫.


–û—Ü–µ–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –†–∏–¥–∂. –î–ª—è –†–∏–¥–∂-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–≥—Ä–µ–±–Ω–µ–≤–æ–π) —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è Œª –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –æ—Ü–µ–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. 
```{r}
lambdas <- seq(0, 150, by = 0.025)

set.seed(1877)
cv_ridge <- cv.glmnet(train_x, train_y, alpha = 0, lambda = lambdas)
plot(cv_ridge)
```

–ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å MSE (—Å—Ä–µ–¥–Ω–µ–π –∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏) –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è  –æ—Ç Œª. 
–û–¥–Ω–∞ –∏–∑ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π –ø—É–Ω–∫—Ç–∏—Ä–Ω—ã—Ö –ª–∏–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º–∞ MSE. –í—Ç–æ—Ä–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç —Ç–æ—á–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–æ ¬´–ø—Ä–∞–≤–∏–ª—É –æ–¥–Ω–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–∏¬ª.

–û–ø—Ä–µ–¥–µ–ª–∏–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è Œª –∏—Å—Ö–æ–¥—è –∏–∑ –º–∏–Ω–∏–º—É–º–∞ –æ—à–∏–±–æ–∫
```{r}
cv_ridge$lambda.min
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –†–∏–¥–∂
```{r}
set.seed(1877)
m_ridge <- glmnet(train_x, train_y, alpha = 0, lambda = cv_ridge$lambda.min)
coef(m_ridge)
```

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$ridge <- predict(m_ridge, s = cv_ridge$lambda.min, newx = test_x)

ggplot(test, aes(x = thalach, y = ridge)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–û—Ü–µ–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ LASSO (Least Absolute Shrinkage and Selection Operator)

–ú–µ—Ç–æ–¥ LASSO
–ú–µ—Ç–æ–¥ Lasso –Ω–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –º–µ—Ç–æ–¥–∞ –≥—Ä–µ–±–Ω–µ–≤–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —Å—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞ 
–ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Ä—è–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
–ú–µ—Ç–æ–¥ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ ¬´–õ–∞—Å—Å–æ¬ª (LASSO, Least Absolute Shrinkage and Selection Operator) 
–∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤–æ –≤–≤–µ–¥–µ–Ω–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª 
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏, —á—Ç–æ —á–∞—Å—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
–í –º–µ—Ç–æ–¥–µ Lasso –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –≤–≤–æ–¥–∏—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å.

```{r}
set.seed(1886)
cv_lasso <- cv.glmnet(train_x, train_y, alpha = 1, lambda = lambdas)
plot(cv_lasso)
```
–û–ø—Ä–µ–¥–µ–ª–∏–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è Œª –∏—Å—Ö–æ–¥—è –∏–∑ –º–∏–Ω–∏–º—É–º–∞ –æ—à–∏–±–æ–∫
```{r}
cv_lasso$lambda.min
```

–ü–æ—Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ Lasso.
```{r}
set.seed(1886)
m_lasso <- glmnet(train_x, train_y, alpha = 1, lambda = cv_lasso$lambda.min)
coef(m_lasso)
```
–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
```{r}
test$lasso <- predict(m_lasso, s = cv_lasso$lambda.min, newx = test_x)
ggplot(test, aes(x = thalach, y = lasso)) + geom_point() + geom_abline() + scale_x_continuous(limits = c(75, 200), expand = c(0, 0)) + scale_y_continuous(limits = c(75, 200), expand = c(0, 0))
```

–†–∞—Å—Å—á–∏—Ç–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
- MAPE - —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö,
- RMSE - –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –∏–∑ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏,
- MAE - —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞.

```{r}
predict <- data.frame(
  MAPE = MAPE(x = test$predict, ref = test$thalach)*100, 
  RMSE = RMSE(x = test$predict, ref = test$thalach), 
  MAE = MAE(x = test$predict, ref = test$thalach)
)

ridge <- data.frame(
  MAPE = MAPE(x = test$ridge, ref = test$thalach)*100, 
  RMSE = RMSE(x = test$ridge, ref = test$thalach), 
  MAE = MAE(x = test$ridge, ref = test$thalach)
)

lasso <- data.frame(
  MAPE = MAPE(x = test$lasso, ref = test$thalach)*100, 
  RMSE = RMSE(x = test$lasso, ref = test$thalach), 
  MAE = MAE(x = test$lasso, ref = test$thalach)
)
```

```{r}
data.frame(rbind.data.frame(predict, ridge, lasso), row.names = c("–ú–µ—Ç–æ–¥ –Ω–∞–∏–º. –∫–≤–∞–¥—Ä–∞—Ç–æ–≤", "Ridge", "LASSO"))
```

–ú–µ—Ç–æ–¥ Ridge –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—å—à—É—é –æ—à–∏–±–∫—É. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–≥–Ω–æ–∑ –º–µ—Ç–æ–¥–æ–º LASSO –∏ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∞ VIF-–∫—Ä–∏—Ç–µ—Ä–∏–π < 10. –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å –æ—Ç—Å—É—Å—Ç–≤—É–µ—Ç. 
